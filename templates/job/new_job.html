<button type="button" class="btn btn-primary btn-sm" data-toggle="modal" data-target=".new-job-modal">
	新建任务
</button>
<button type="button" class="btn btn-primary btn-sm" id='job_refresh'>
	刷新
</button>
<div class="modal fade new-job-modal" tabindex="-1" role="dialog" aria-labelledby="myolModal">
  	<div class="modal-dialog modal-lg">
	    <div class="modal-content">
	      	<div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
		        <h4 class="modal-title" id="myModalLabel">新建任务</h4>        
	      	</div>
		    <div class="modal-body">
		        <form id='NewJobForm'>
		        	<div class="input-group col-lg-4">
						    <span class="input-group-addon" id="basic-addon1">任务名称</span>
						  	<input id="Job_name" type="text" class="form-control" placeholder="任务名称" aria-describedby="basic-addon1">
					</div>								
				</form>
		    </div>
		    <div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
		        <button type="button" class="btn btn-primary" data-dismiss="modal" id='SubmitJob'>提交</button>
		    </div>
	    </div>
  	</div>
</div>	

<div class="panel panel-primary" style="margin-top: 2px;margin-right: 5px;">
	<table class="table"  style="table-layout: fixed;WORD-BREAK: break-all; WORD-WRAP: break-word">
      	<thead>
          	<tr>
	            <th>作业ID</th>
	            <th>作业名称</th>
	            <th>用户名</th>
	            <th>队列</th>
	            <th>开始时间</th>
	            <th>运行时间</th>
	            <th>运行状态</th>
          	</tr>
		</thead>
      	<tbody id="reload" class='false'>
	          	
					{% for i in job_data %}
						<tr>
							<th>{{ i.job_id }}</th>
							<th>{{ i.job_name }}</th>
							<th>{{ i.job_user_name }}</th>
							<th>{{ i.job_queue }}</th>
							<th>{{ i.job_start_time }}</th>
							<th>{{ i.job_run_time }}</th>
							<th>{{ i.job_status }}</th>
						</tr>
					{% endfor %}
	          	
		</tbody>
		
	</table>						
</div>


<script type="text/javascript">
	$('#SubmitJob').click(function() {
	//$('.new-job-modal').on('shown.bs.modal',function(){
		var temp = $('#Job_name').val();
		$.ajax({
			type:"post",
			url:"{% url 'new_job' %}",
			data:{job_name:temp},
			//async:true,
			success:function(arg){
				var obj = jQuery.parseJSON(arg)
				//arg为
				//$('.result').text(obj);
				console.log(obj);	
				
				//alert('Your job is success submit!');
			},
			error:function(arg){
				//console.log(arg)
			}
			
		});
		
	});
	function job_refresh(){
		var url = "{% url 'new_job' %}";
		$('#content').load(url);
	}
	$('.new-job-modal').on('hidden.bs.modal',function(){
		job_refresh();
	})
	$('#job_refresh').click(function(){
		job_refresh();
	});


			




		

	
</script>